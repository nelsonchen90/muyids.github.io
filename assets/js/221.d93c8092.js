(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{386:function(v,a,t){"use strict";t.r(a);var _=t(42),e=Object(_.a)({},(function(){var v=this,a=v.$createElement,t=v._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("p",[v._v("以设计weibo为例，4s分析法解决")]),v._v(" "),t("h2",{attrs:{id:"scenario-场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scenario-场景"}},[v._v("#")]),v._v(" Scenario 场景")]),v._v(" "),t("p",[v._v("询问面试官")]),v._v(" "),t("ol",[t("li",[v._v("需要设计哪些功能（也可以自己想）")]),v._v(" "),t("li",[v._v("需要承受多大的访问量？")])]),v._v(" "),t("h2",{attrs:{id:"service-服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#service-服务"}},[v._v("#")]),v._v(" Service 服务")]),v._v(" "),t("p",[v._v("将大系统拆分为小服务")]),v._v(" "),t("ol",[t("li",[v._v("Replay重放需求")]),v._v(" "),t("li",[v._v("Merge归并需求")])]),v._v(" "),t("h2",{attrs:{id:"storage-存储"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#storage-存储"}},[v._v("#")]),v._v(" Storage 存储")]),v._v(" "),t("p",[v._v("内存\n某些数据不需要持久化，直接内存保存就可以")]),v._v(" "),t("p",[v._v("数据库\n存储结构化的数据\n分为 关系型数据和非关系型数据，如何做选择？")]),v._v(" "),t("p",[v._v("文件系统\n分布式文件系统，存储非结构化的数据，比如图片、视频等")]),v._v(" "),t("ol",[t("li",[v._v("为每个Service选择存储结构")]),v._v(" "),t("li",[v._v("Schema 细化表结构")])]),v._v(" "),t("h1",{attrs:{id:"设计twitter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设计twitter"}},[v._v("#")]),v._v(" 设计twitter")]),v._v(" "),t("p",[v._v("设计朋友圈、微博")]),v._v(" "),t("h2",{attrs:{id:"场景分析senario"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#场景分析senario"}},[v._v("#")]),v._v(" 场景分析Senario")]),v._v(" "),t("p",[v._v("功能：")]),v._v(" "),t("ol",[t("li",[v._v("发推，发帖")]),v._v(" "),t("li",[v._v("获取自己和关注的人的帖子")]),v._v(" "),t("li",[v._v("关注某人")]),v._v(" "),t("li",[v._v("取关某人")])]),v._v(" "),t("h2",{attrs:{id:"服务分析-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务分析-service"}},[v._v("#")]),v._v(" 服务分析 Service")]),v._v(" "),t("p",[v._v("拆成两个服务，用户服务和帖子服务")]),v._v(" "),t("h3",{attrs:{id:"用户服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户服务"}},[v._v("#")]),v._v(" 用户服务")]),v._v(" "),t("p",[v._v("用户有关注和取关别人的功能")]),v._v(" "),t("h3",{attrs:{id:"帖子服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帖子服务"}},[v._v("#")]),v._v(" 帖子服务")]),v._v(" "),t("p",[v._v("发帖功能")]),v._v(" "),t("p",[v._v("获取某人和关注的人最近的帖子")]),v._v(" "),t("h2",{attrs:{id:"存储分析-storage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储分析-storage"}},[v._v("#")]),v._v(" 存储分析 Storage")]),v._v(" "),t("p",[v._v("用户关注关系 存储到 set集合（或hashTable），同时记录"),t("code",[v._v("关注了谁")]),v._v("和"),t("code",[v._v("被谁关注")]),v._v("两个集合")]),v._v(" "),t("p",[v._v("每个用户的发帖记录 存储到 链表（或zset）")]),v._v(" "),t("p",[v._v("每个用户的最新帖子列表用大顶堆（按发帖时间倒序），堆元素为帖子（帖子id, 发帖人id, 发帖时间）；")]),v._v(" "),t("p",[v._v("维护最新帖子列表：")]),v._v(" "),t("ul",[t("li",[v._v("当用户发帖时，帖子加入到大顶堆；当用户删帖时，记录帖子被删除状态；")]),v._v(" "),t("li",[v._v("当用户关注某人时，将此人的帖子加入到大顶堆；")]),v._v(" "),t("li",[v._v("拉取最新帖子列表时，判断发帖人是否已经被取关 和 帖子是否已经被删除")])]),v._v(" "),t("h2",{attrs:{id:"扩展分析-scale"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#扩展分析-scale"}},[v._v("#")]),v._v(" 扩展分析 Scale")]),v._v(" "),t("p",[v._v("为什么明星结婚之类的突发事件，会造成微博挂掉？")])])}),[],!1,null,null,null);a.default=e.exports}}]);