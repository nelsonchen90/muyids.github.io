(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{579:function(a,e,s){"use strict";s.r(e);var t=s(42),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("测试机部署zookeeper集群")]),a._v(" "),s("ul",[s("li",[a._v("129.0.4.32")]),a._v(" "),s("li",[a._v("129.0.4.33")]),a._v(" "),s("li",[a._v("129.0.4.34")])]),a._v(" "),s("h1",{attrs:{id:"下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[a._v("#")]),a._v(" 下载")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://zookeeper.apache.org/\ncd /app/\nwget https://mirrors.bfsu.edu.cn/apache/zookeeper/zookeeper-3.6.1/apache-zookeeper-3.6.1-bin.tar.gz\ntar -zxvf apache-zookeeper-3.6.1-bin.tar.gz -C /app/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h1",{attrs:{id:"配置数据存储目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置数据存储目录"}},[a._v("#")]),a._v(" 配置数据存储目录")]),a._v(" "),s("p",[a._v("mkdir -p /data/zkData")]),a._v(" "),s("h1",{attrs:{id:"配置服务器id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器id"}},[a._v("#")]),a._v(" 配置服务器id")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cd /data/zkData\ntouch myid\necho xxxx(服务器编号) >> myid\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h1",{attrs:{id:"修改配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[a._v("#")]),a._v(" 修改配置文件")]),a._v(" "),s("p",[a._v("conf这个路径下的zoo_sample.cfg修改为zoo.cfg；")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cd /app/apache-zookeeper-3.6.1-bin/conf\ncp zoo_sample.cfg zoo.cfg\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("修改数据存储路径"),s("code",[a._v("vi zoo.cfg")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("dataDir=/data/zkData\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改cluster配置")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#######################cluster########################## \nserver.2=129.0.4.32:2888:3888\nserver.3=129.0.4.33:2888:3888\nserver.4=129.0.4.34:2888:3888\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h1",{attrs:{id:"启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),s("p",[s("code",[a._v("/app/apache-zookeeper-3.6.1-bin/bin/zkServer.sh start")])]),a._v(" "),s("h1",{attrs:{id:"查看进程是否启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看进程是否启动"}},[a._v("#")]),a._v(" 查看进程是否启动")]),a._v(" "),s("p",[a._v("jps")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("10743 Jps\n10666 QuorumPeerMain\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h1",{attrs:{id:"查看状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看状态"}},[a._v("#")]),a._v(" 查看状态")]),a._v(" "),s("p",[s("code",[a._v("/app/apache-zookeeper-3.6.1-bin/bin/zkServer.sh status")])]),a._v(" "),s("p",[a._v("输出")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ZooKeeper JMX enabled by default\nUsing config: /app/apache-zookeeper-3.6.1-bin/bin/../conf/zoo.cfg\nClient port found: 2181. Client address: localhost.\nMode: follower\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("几种Mode:")]),a._v(" "),s("ul",[s("li",[a._v("standalone : 单机")]),a._v(" "),s("li",[a._v("follower : cluster中的跟随者")]),a._v(" "),s("li",[a._v("leader : cluster中的leader")])]),a._v(" "),s("h1",{attrs:{id:"客户端操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端操作"}},[a._v("#")]),a._v(" 客户端操作")]),a._v(" "),s("h2",{attrs:{id:"启动-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-2"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),s("p",[a._v("/app/apache-zookeeper-3.6.1-bin/bin/zkCli.sh")]),a._v(" "),s("h2",{attrs:{id:"退出客户端："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#退出客户端："}},[a._v("#")]),a._v(" 退出客户端：")]),a._v(" "),s("p",[a._v("quit")]),a._v(" "),s("h1",{attrs:{id:"停止zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#停止zookeeper"}},[a._v("#")]),a._v(" 停止zookeeper")]),a._v(" "),s("p",[a._v("/app/apache-zookeeper-3.6.1-bin/bin/zkServer.sh stop")]),a._v(" "),s("h1",{attrs:{id:"配置参数解读"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置参数解读"}},[a._v("#")]),a._v(" 配置参数解读")]),a._v(" "),s("p",[a._v("解读zoo.cfg 文件中参数含义")]),a._v(" "),s("h2",{attrs:{id:"ticktime-2000：通信心跳数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ticktime-2000：通信心跳数"}},[a._v("#")]),a._v(" tickTime=2000：通信心跳数")]),a._v(" "),s("p",[a._v("tickTime：通信心跳数，Zookeeper服务器心跳时间，单位毫秒")]),a._v(" "),s("p",[a._v("Zookeeper使用的基本时间，服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每个tickTime时间就会发送一个心跳，时间单位为毫秒。")]),a._v(" "),s("p",[a._v("它用于心跳机制，并且设置最小的session超时时间为两倍心跳时间。(session的最小超时时间是2*tickTime)。")]),a._v(" "),s("h2",{attrs:{id:"initlimit-10：lf初始通信时限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initlimit-10：lf初始通信时限"}},[a._v("#")]),a._v(" initLimit=10：LF初始通信时限")]),a._v(" "),s("p",[a._v("initLimit：LF初始通信时限")]),a._v(" "),s("p",[a._v("集群中的follower跟随者服务器(F)与leader领导者服务器(L)之间初始连接时能容忍的最多心跳数（tickTime的数量），用它来限定集群中的Zookeeper服务器连接到Leader的时限。")]),a._v(" "),s("p",[a._v("投票选举新leader的初始化时间。")]),a._v(" "),s("p",[a._v("Follower在启动过程中，会从Leader同步所有最新数据，然后确定自己能够对外服务的起始状态。")]),a._v(" "),s("p",[a._v("Leader允许F在initLimit时间内完成这个工作。")]),a._v(" "),s("h2",{attrs:{id:"synclimit-5：lf同步通信时限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#synclimit-5：lf同步通信时限"}},[a._v("#")]),a._v(" syncLimit=5：LF同步通信时限")]),a._v(" "),s("p",[a._v("syncLimit：LF同步通信时限")]),a._v(" "),s("p",[a._v("集群中Leader与Follower之间的最大响应时间单位，假如响应超过syncLimit * tickTime，")]),a._v(" "),s("p",[a._v("Leader认为Follwer死掉，从服务器列表中删除Follwer。")]),a._v(" "),s("p",[a._v("在运行过程中，Leader负责与ZK集群中所有机器进行通信，例如通过一些心跳检测机制，来检测机器的存活状态。")]),a._v(" "),s("p",[a._v("如果L发出心跳包在syncLimit之后，还没有从F那收到响应，那么就认为这个F已经不在线了。")]),a._v(" "),s("h2",{attrs:{id:"datadir：数据文件目录-数据持久化路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#datadir：数据文件目录-数据持久化路径"}},[a._v("#")]),a._v(" dataDir：数据文件目录+数据持久化路径")]),a._v(" "),s("p",[a._v("dataDir：数据文件目录+数据持久化路径")]),a._v(" "),s("p",[a._v("保存内存数据库快照信息的位置，如果没有其他说明，更新的事务日志也保存到数据库。")]),a._v(" "),s("h2",{attrs:{id:"clientport-2181：客户端连接服务器端口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#clientport-2181：客户端连接服务器端口"}},[a._v("#")]),a._v(" clientPort=2181：客户端连接服务器端口")])])}),[],!1,null,null,null);e.default=r.exports}}]);